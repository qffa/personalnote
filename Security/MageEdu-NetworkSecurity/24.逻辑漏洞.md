# 逻辑漏洞

程序逻辑有问题

所有的漏洞都是根据功能来的



**注册处**

任意用户注册、短信轰炸等问题

暴力破解短信验证码

批量注册

自动识别验证码平台


**登陆处**

邮箱轰炸、短信轰炸、验证码爆破

任意用户登陆


**密码找回**


**支付与越权**

篡改价格

保证功能的原子性，例如

第一步 发验证码
第二步 输入新密码
第三步 修改成功

可以在第二步修改包，把手机号改成别人的，从而把别人的密码改了


**支付漏洞案例**


webug

```
docker pull area39/webug
```


**修改密码**

不验证旧密码

**验证码回传**

任意用户注册

**任意用户登陆**

注册成功只后，直接登陆，不进行账号密码验证

抓包替换 userid

**任意密码重置**

抓包修改字段

## 逻辑漏洞修复

1. 严格控制用户权限，不要使用简单的 cookie 或 session
2. 控制发送手机验证码时间间隔
3. 加入用户身份认证或 token 验证
4. json 字符串加密
5. HMAC
6. 防重放攻击，加时间戳
7. 避免仅使用前端校验
