# C编译过程

C语言编译的四个阶段

```mermaid
graph LR
  预处理 --> 编译
  编译 --> 汇编
  汇编 --> 链接
```

## 各阶段详细介绍

**预处理**

- 处理宏定义
- 处理头文件包含
- 处理条件编译
- 处理特殊预处理关键字
- 处理注释

**编译**

- C源码转汇编代码

**汇编**

- 汇编源码转二进制目标文件

**链接**

- 将多个二进制目标文件合并
- 加入启动代码
- 链接动态库、静态库


## 相关程序

| 程序     | 作用     | 输出文件 | 说明                     |
|:-------- |:-------- |:-------- |:---------------------- |
| cpp      | 预编译   | xxx.i    |                         |
| cc1      | 编译     | xxx.s    | 也具有cpp功能            |
| as       | 汇编     | xxxx.o   |                         |
| ld       | 链接     | a.out    |                         |
| collect2 | 链接     | a.out    | 对ld的二次封装           |
| gcc      | 管理程序 | 以上任意  | 调度以上程序完成编译过程  |


## gcc参数

**-E**： 只做预处理  
**-S**： 只编译  
**-c**： 只汇编  
**-g**： 加入调试信息  
**-v**： 输出详细信息  
**-o**： 输出到指定文件  
**-s**： 出文件瘦身  
**-Wall**： 显示所有警告  
**-std=xxx**： 指定编译标准  
