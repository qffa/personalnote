# 静态链接与动态链接

静态链接在编译时完成  
动态链接在程序运行起来后进行

## 静态链接

**什么是静态链接**

静态链接，就是在编译时，调用`ld`, `collect2`链接程序，将所有的`.o`中的机器指令整合到一起，然后保存到可执行文件中。

静态链接主要做两件事

- 符号解析
- 地址重定位

**符号解析**

根据符号表，将符号的引用与定义联系起来。

例如：模块a（a.o）中引用了模块b（b.o）中的函数`fun`。静态链接后，a模块调用`fun`的代码会根据符号表指向真实的`fun`函数所在的地址。

**重定位**

`.o`文件中每个节（`.text`, `.rodata`, `.data`等），逻辑地址都是从`0`开始的。这只是临时分配的，不是实际运行的物理地址。

重定位时，链接程序先将各个模块聚合在一起，然后重定位实际运行地址。

查看逻辑地址

```
$ objdump -D helloworld.o > hw1.s
```

## 动态链接

动态链接，就是在编译的时候只留下调用接口，当程序真正运行的时候，才去链接执行。使用动态库时，动态库就是动态链接的

动态链接由**动态链接器**实现 `-dynamic-linker /lib64/ld-linux-x86-64.so.2`
