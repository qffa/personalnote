# 代码复用

在早期的开发中人们就开始意识到，有些函数代码是会被经常重复用到的。如果每一次编写程序时，都重新实现这些函数的话，不利于提高编程的效率。所以必须想办法提高常用函数代码的重复利用率，以提高开发效率。

## 以源码方式复用

从源码库或者其他源文件中拷贝过来直接用。

**优点**

- 方便、快捷
- 可以了解源码实现

**缺点**

- 不利于版权保护
- 要知道哪个函数在哪个.c中，源文件多了，可不好找
- 编译C源码很耗时间

## 以二进制文件方式复用

直接把需要的`.o`文件拿过来，放到工程里链接。

**优点**

- 保护源码
- 节省编译时间

**缺点**

- `.o`文件非常多时，很难记住哪个函数在哪个`.o`之中。

基于这样的原因就有了**函数库**。库其实就是就是将`.o`进行打包，做成库文件。
链接库时，库会自动识别我们程序中调用的函数在哪些`.o`中，然后自动找到那些`.o`，然后连接到我们的程序中。
静态库中有函数的索引。

## 以库方式复用

**复用方式**

1. 先将要复用的源码`.c`编译为对应的`.o`，然后再将所有的`.o`打包做成“库”文件。
2. 使用时，直接链接“库文件”即可，在程序中调用了某个函数，链接库文件时会自动帮我搜索这个函数在库中的哪些`.o`中，然后就链接库中这些`.o`

**优点**

- 不需要公开源码，维护了版权
- 不需要浪费额外的编译时间，因为事先就编译好了，只需要链接即可
- 也不需要人为的挑选`.o`，链接库时会自动的搜素

## 库的分类

**静态库**

- windows中的`.lib`
- Linux中的`.a`

**动态库**

- windows中的`.dll`
- Linux中的`.so`
