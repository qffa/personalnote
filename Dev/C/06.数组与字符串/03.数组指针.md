# 数组指针

## 指针数组

指针数组是个数组，他的每个元素是个指针。

**例如**

```
int *buf[5];
```

**说明**

- 每个元素为`int *`型
- `&buf[0]` 为指针变量的地址，显然是`int **`型

## 数组指针

即数组的指针。以`int buf[10]`为例：

buf

- 数组第0个元素指针，等价于`&buf[0]`
- buf的指针类型为`int *`

&buf

- 一维数组的数组指针
- `&buf`的类型为`int(*)[10]`

## 数组指针类型

将数组定义中的数组名替换成 `*` ，并用 `(` `)`括起来，类似函数指针类型

```
int (*)[10]     // int buf[10]的指针类型
```

## 数组指针变量

```
int (*p)[10] = &buf;
```

定义数组指针变量时，元素个数不能省略。否则指针加n时，就无法知道移动多远了。

## 数组指针解引用

对数组指针解引用得到数组，即数组第0个元素指针

对比

```
int buf[10];

int *p1 = buf;  //数组第一个元素指针（地址）
int (*p2)[10] = &buf;  //数组指针（地址）

/* 说明 */
// *p2     对数组指针解引用得到数组，即数组第0个元素指针
// *&buf   同上
// buf     同上
// *p1     对数组第一个元素指针解引用，得到第一个元素的值
// *buf    同上
// &p1     变量p1的地址
```

## 数组指针强制转换

```
int main(void) {
    int buf[10];

    int (*p1)[8] = (int (*)[8])&buf;

    char (*p2)[8] = (char (*)[8])&buf;

    int *p3 = (int *)&buf;  //将数组指针强转为数组第一个元素指针

    int *p4 = *&buf;

    int (*p5)[10] = (int (*)[10])buf;  //将数组第一个元素指针强转为数组指针

}
```
注意：

如果没有强制转换需求的话，最好不要进行强制转换，因为这会导致访问数组空间时，解释方式发生了变化， 这会导致解释空间时多访问空间，或者少访问空间。

## 使用数组指针传参

可以解引用得到数组或者强转

```
#include <stdio.h>

void fun(int n, int (*p)[n]){
    int i = 0;
    for(i=0; i<n; i++)
        printf("%d ", (*p)[i]);  //解引用得到数组第一个元素指针
    //等效以下
    int *p1 = (int*)p;  //强转为第一个元素指针
    for(i=0; i<n; i++)
        printf("%d ", *(p1+i));
}
int main(void) {

    int buf[10] = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9};

    fun(10, &buf);

    printf("\n");

    return 0;
}
```
