# c标准库

## 有关C标准

c89(c90)/c99/c11

真正的c标准应该包含两部分内容，一部分用于描述c标准语法，另一个部分则描述c标准库，一个平台如果说要完整的支持c语言的话，不仅仅要实现c编译器（解释c语法），还要实现c标准库，这样才算符合c标准。

各个平台在实现c标准时，大体上可能会存在两种情况：

- 超额符合
- 缩水符合

**超额符合**

超额符合就是，不仅实现了c编译器，实现了c标准库，而且还额外的多提供了很多自己平台的c库函数。
比如Linux下glibc，这个是GNU为linux开发的c库，这个c库>c标准库，或者叫c标准库的超集。
glibc除了提供了基本的c标准库函数外，还提供了Linux平台独有的c库函数，甚至包括了Linux的OS API。

**缩水符合**

出现这种情况最多的是单片机开发平台，由于单片机本身的计算机资源的有限，运行完整C库会很吃力。
所以很多单片机平台（IDE）往往只提供了c编译器，只能对基本的c标准语法进行解释，但是并没有提供完整的c标准库。
不过有些单片机平台（比如stm32）可能会提供“微缩”版的c标准库，以适应单片机资源有限的情况。

**注意**

大多数平台在实现编译器时，除了支持c标准语法外，往往都会加一些 属于自己的特有语法，想这些c语法只能由该平台的编译器识别，其它平台的编译器是无法识别的，如果我们希望我们 c代码能够在不同的平台都能编译通过，建议写代码时，尽量使用c标准语法。

## C标准子库

### 标准IO库

作用：提供标准IO函数，实现输入输出操作

头文件：stdio.h

函数举例：printf、scanf、getchar、fopen、fclose、fprintf、fscanf、sprintf、fwrite、fread、perror等函数

###ctype库

作用：提供字符操作函数，专门用于字符进行处理

头文件：ctype.h

函数举例：

- isalnum：判断字符是否为字母或者数字，比如' '（空格），这个字符既不是字母也不是数字
- salpha：判断字符是否为字母，比如'a'就为字母
- isdigit：判断字符是否为数字，比如'1'就为数字
- scntrl：判断字符是否为控制字符，比如回车、换行、D删除、退格等字符就控制字符。
- islower：判断是否为小写字母
- toupper：将小写字母转为大写字母

###字符串处理函数库

作用：提供字符操作函数，专门用于字符进行处理

头文件：string.h

函数举例：

- strcat：把某个字符串接到另一个字符串的后面
- strchr：在字符串中，找出第一次出现某字符的位置
- strcmp：对比两个字符串是否相等
- strcpy：将字符串复制到一个字符串数组空间中
- strlen：统计字符串中字符的个数
- strstr：在字符串中，找出第一次出现某字符串的位置
- strerror：将错误号转换为字符串，用于提示函数出了什么错

字符串处理函数库使用非常频繁

###数学库

作用：提供数学函数

头文件：math.h

函数举例：

- abs：求整数的绝对值
- abs：求浮点数的绝对值
- cos：计算余弦值
- sin：计算正选值
- sqrt：开方
- log：求对数
- log10：求log10x
- pow：计算某个数的n次幂

###基础工具函数库

作用：提供基础的工具函数，比如内存管理、字符串转换、随机数、进程环境等

头文件：stdlib.h

函数举例：

- atof：将字符串转成浮点数，比如将"234.56"转为浮点数234.56
- atoi：将字符串转成整形数，比如将"234"转为整形数234
- atol：将字符串转成长整形数
- strtod、strtol、strtoul：这几个函数稍微有点麻烦，这里就先不介绍了。
- rand：产生随机数
- srand：设置产生随机数的种子
- malloc：从堆内存中分配变量空间
- calloc：calloc与malloc最大的区别是，calloc会清零开辟的变量空间
- realloc：重新开辟空间，常用于扩充变量空间
- aligned_alloc：分配对齐的变量空间
- free：释放开辟堆变量空间
- abort：进程给自己发送一个信号，将自己异常终止
- exit：在程序的任何函数中调用exit时，程序会正常终止
- atexit：注册进程退出处理函数，进程（程序）在终止时，会调用退出处理函数进行扫尾处理。
- system：开辟一个子进程，然后执行另一个新程序
- getenv：获取某个环境变量
- setenv：设置环境变量

###时间函数库

作用：提供用于获取系统（OS）时间的函数

头文件：time.h

函数举例：

- gmtime：将一个总秒数的时间，转成年月日分秒，放到一个结构体中，供我们使用
- asctime：将结构体中的年月日分秒，转为一个字符串形式的时间
- ctime：直接将累计的总秒数，直接转为字符串形式的时间，比如将总秒数5443434234转
- mktime、localtime：...

###信号处理函数

作用：用于处理信号

头文件：signal.h

函数举例：

- signal：捕获信号，并处理信号
- raise：给自身发送信号

###线程函数

作用：实现多线程

头文件：thread.h

函数举例：

- thrd_create：创建线程
- thrd_detach：通知操作系统，当线程结束时由操作系统负责释放线程所占用的计算机资源
- thrd_exit：此函数用于结束当前线程

注意：

c标准库从2011（c11标准的推出时间）后才开始提供c线程库，老版本的编译器可能都不支持c标准库的c线程库。 但是这些编译器可能会提供其它的c线程库，比如gcc编译器提供的是posix线程库，头文件为pthread.h

posix线程库的线程函数为：

- pthread_create：功能同thrd_create
- pthread_detach：功能同thrd_detach
- pthread_exit：功能同thrd_exit

## C标准库头文件

c标准库提供了很多的头文件，从c89到c11标准，一直都有不断的添加新的头文件。 几乎所有c标准库的头文件，在编译器的安装目中都能找到。

**两类头文件**

- 功能性头文件
- 辅助性头文件

**功能性头文件**

例如：stdio.h、ctype.h、sting.h、math.h、stdlib.h、time.h、signal.h

内容：库函数会用的宏定义、结构体类型定义、内联函数定义、typdef类型等外、以及库函数声明。

**辅助性头文件**

特点：

- 主要是各类宏定义、结构体类型定义，很少放函数声明
- 使用不频繁

常用的辅助性头文件

- assert.h：程序调试所用的“断言”宏，就定义在了这个.h中，有关断言，我们第8章再介绍
- errno.h：函数报错时所用到的各种错误号，就定义坐在了这个.h中，有关函数报错，我们在第8章会介绍
- stdarg.h：可变参数要用的头文件
- stddef.h：定义某些特殊宏，如offsetof宏
- stdbool.h(C99)：布尔类型，也就是如果你想使用true、flase来表示真假时，就需要使用这个头文件

其他辅助性头文件

- complex.h(C99)：与复数运算有关
- fenv.h(C99)：浮点数环境
- float.h：浮点数类型的极限
- inttypes.h(C99)：整数类型的格式转换
- iso646.h(C95)：符号的替代写法
- limits.h：基本类型的大小
- locale.h：本地化工具
- stdatomic.h(C11)：原子类型
- stdint.h(C99)：定宽整数类型
- stdnoreturn.h：(C11)	noreturn 便利宏
- tgmath.h(C99)：泛型数学（包装 math.h 和 complex.h 的宏）
- uchar.h(C11)：UTF-16 和 UTF-32 字符工具
- wchar.h(C95)：扩展多字节和宽字符工具
- wctype.h(C95)：用来确定包含于宽字符数据中的类型的函数
- stdalign.h(C11)：定义了alignas和alignof，这两个宏与对齐有关，目前了解即可
- setjmp.h：非局部跳转（长跳转）与goto类似，不过goto只能用于函数内部跳转，共同属于局部条转。非局部跳转则是用于实现函数之间的跳转长跳转。尽量不要使用。
