# 静态库与动态库

## 静态库

静态库也被称为静态链接库。静态链接的特点是，所有的.o的代码会组合到一起，最终得到“可执行程序”会包含静态链接的所有的.o的代码

**静态库的缺点**

由于不管有多少个程序链接了静态库，链接时都会包含一份独立的代码到程序中，当这些程序同时运行在同一台 计算机上时，这些重复的代码会比较浪费存储空间。

**制作静态库**

先编译源码得到`.o`，然后再将所有的`.o`打包为“静态库文件”。

**使用静态库**

链接时，直接将库中`xx.o`中代码链接到自己的程序中。
静态库只是对所有的`.o`进行了打包，在连接库中`.o`文件，与链接一般的`.o`文件没有任何区别。

## 动态库

动态库也叫“动态链接库”，链接动态库过程为动态链接，动态链接的特点是，链接时并不会直接将库中`.o`文件中的代码直接链接到我们的程序中，只会包含对应的函数接口。

**动态库的特点**

不管多少个程序链接了动态库，都只会留下动态库函数的接口，调用动态库函数时共享的同一个动态库的代码。

**制作动态库**

编译源码得到`.o`，然后再将所有的`.o`打包为“动态库文件”。

**使用动态库**

编译时链接动态库，程序中预留动态库的函数接口，但并不包含库函数代码。

运行链接了动态库的程序时，首先检测内存中有没有动态库代码，如果没有的话程序中的“动态库加载器”就会将 所需整个动态库代码从硬盘加载到内存中，程序通过函数接口（函数名（函数指针））调用动态库的函数时，就会跳转到动态库中去调用动态库的函数代码。

## 对比静态库与动态库

- 静态库和动态库都是各种.o打包后的集合体，这个集合体就是“库文件”
- 链接静态库时，自动在库中找到xxx.o，然后将代码和自己程序的代码组合到一起
- 链接动态库时，不会将代码链接到自己的程序中，只会留下函数接口（函数指针）
- 动态库是因为静态库的缺陷而产生的，但是动态库并不能完全的替代静态库
- 动态库的运行需要OS虚拟内存的支持


## 库的好处

- 可以非常方便复用自己的或前人的劳动成果，以有效提高开发效率
- 库还可以用来实现软件的功能升级比如给原来的程序提供新的功能库，通过这个新的库就可以升级和扩展程序的功能。

## 常见库介绍

- 数学库：各种数学函数，比如开方、平方、sin、cos、log等等数学运算
- GL库：Graphic Library，图形图像算法库
- 音视频库：实现音视频的编解码、滤波去噪、音视频格式转换
- 线程程库：实现多线程

## 实现库的难点

实现库的难点并不在于如何制作和使用库，不管你的库是大还是小，是复杂还是简单，制作和使用的规则都是一样的，没有任何差异，事实上最难的是如何实现库的标准化（规范化）。

所谓标准化就是，让库代码更加的健壮合理，让库函数的功能和函数接口标准化，让库被大多数的编程者所接受，这个是比较难的。

- 个人库，完全为了方便自己使用而存在的东西，库函数的规范带有很强的个人特点
- 公司库，为了方便公司产品开发而制作的库，相比个人的库会更加规范
- c标准库
- 与平台相关c库函数
